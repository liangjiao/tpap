/*! caja-kissy  */
(function(){var n=KISSY,t="r4000",e=location&&-1!==(location.search||"").indexOf("caja-debug")?"http://assets.daily.taobao.net/apps/taesite/balcony/core/":"http://a.tbcdn.cn/apps/taesite/balcony/core/",r=e+t+"/caja/",o="J_TScriptedModule",i={},a={};a.addModsCajoledJS=function(t,e){2>arguments.length||n.isString(t)&&(i[t]=i[t]||";"+e+";")},a.getModsCajoledJS=function(n){return n?i[n]?i[n]:null:null},a.runScriptedMods=function(t,e){var r=KISSY.DOM,a=r.query("."+o);if(a){var s=[];n.each(e,function(n){s.push(n(t))});var u=n.isFunction(window.getCajaExposed)?window.getCajaExposed(t,cajaAFTB):{};n.each(a,function(e){var o=r.attr(e,"data-componentid");if(o){var a=i[o];void 0!==a&&t.makeES5Frame(e,{rewrite:cajaAFTB.rewriteURL},function(o){var i=t.tame(t.markFunction(function(t,e,r){return n.log(t,e,r),!0}));r.attr(o.iframe,"data-modulename",r.attr(o.div,"data-componentid")),cajaAFTB.tameNode||(cajaAFTB.tameNode=function(n){return o.imports.tameNode___(n,!0)},cajaAFTB.checkCss=function(n,t,e){return o.imports.checkCss___(n,t,e)},cajaAFTB.sanitizeHtml=function(n){var t=document.createElement("div");return t=cajaAFTB.tameNode(t),t.innerHTML_s___(n),t.innerHTML_g___()});var c={},l={};n.each(s,function(t){var r=t({frame:o,mod:e});!0===r.kissy?(n.mix(c,r),r.kissy=void 0):n.mix(l,r)});var d=o.contentCajoled("",a),p={KISSY:t.tame(c),onerror:i};p=n.mix(u,p),p=n.mix(p,l),d.run(p,function(){})})}})}},a.setup=function(n){caja.configure({cajaServer:r,debug:location&&-1!==(location.search||"").indexOf("caja-debug")},function(t){a.runScriptedMods(t,n)})},a.registerCajoledMods=function(n,t){a.addModsCajoledJS(n,t)},window.TShop||(window.TShop={}),window.TShop.Balcony=a})();